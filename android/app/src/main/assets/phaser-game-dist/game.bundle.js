(()=>{"use strict";var e,t={429:(e,t,i)=>{var n=i(440),r=i.n(n),a={type:Phaser.WEBGL,parent:"phaser-game-container",backgroundColor:"#000000",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1920,height:1080,min:{width:320,height:180},max:{width:1920,height:1080}},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1,fps:60}},fps:{target:60,forceSetTimeOut:!1,deltaHistory:10,panicMax:120},render:{antialias:!1,pixelArt:!0,roundPixels:!0,transparent:!1,clearBeforeRender:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",batchSize:4096,maxTextures:8,maxLights:6},audio:{disableWebAudio:!1,noAudio:!1},input:{activePointers:2,target:null,touch:{capture:!0},smoothFactor:0},disableContextMenu:!0,banner:!1},o={ULTRA:{particleLimit:200,shadowQuality:"high",effectsEnabled:!0,backgroundComplexity:"full",maxSprites:100},HIGH:{particleLimit:100,shadowQuality:"medium",effectsEnabled:!0,backgroundComplexity:"reduced",maxSprites:80},MEDIUM:{particleLimit:50,shadowQuality:"low",effectsEnabled:!0,backgroundComplexity:"simple",maxSprites:60},LOW:{particleLimit:25,shadowQuality:"none",effectsEnabled:!1,backgroundComplexity:"minimal",maxSprites:40},POTATO:{particleLimit:10,shadowQuality:"none",effectsEnabled:!1,backgroundComplexity:"none",maxSprites:20}};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach(function(t){l(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function l(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}var p=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.messageHandlers=new Map,this.pendingMessages=new Map,this.messageId=0,this.isReady=!1,this.performanceMetrics={avgLatency:0,messageCount:0,lastMessageTime:0},this.initializeBridge()},t=[{key:"initializeBridge",value:function(){window.ReactNativeWebView?(this.postMessage=this.createOptimizedPostMessage(),this.setupMessageListener(),this.sendHandshake()):this.setupDevelopmentBridge()}},{key:"createOptimizedPostMessage",value:function(){var e=this;return function(t,i){var n={id:++e.messageId,type:t,data:i,timestamp:performance.now()};return e.performanceMetrics.lastMessageTime=n.timestamp,window.ReactNativeWebView.postMessage(JSON.stringify(n)),n.id}}},{key:"setupMessageListener",value:function(){var e=this;window.addEventListener("message",function(t){try{var i="string"==typeof t.data?JSON.parse(t.data):t.data;if(i.timestamp){var n=performance.now()-i.timestamp;e.updateLatencyMetrics(n)}e.routeMessage(i)}catch(e){}})}},{key:"setupDevelopmentBridge",value:function(){var e=this;this.postMessage=function(t,i){return setTimeout(function(){e.routeMessage({type:"".concat(t,"_response"),data:u({success:!0},i)})},10),++e.messageId},this.isReady=!0}},{key:"sendHandshake",value:function(){this.send("BRIDGE_HANDSHAKE",{version:"1.0.0",capabilities:["binary_protocol","message_channels","performance_metrics","batch_updates"]})}},{key:"on",value:function(e,t){this.messageHandlers.has(e)||this.messageHandlers.set(e,[]),this.messageHandlers.get(e).push(t)}},{key:"off",value:function(e,t){var i=this.messageHandlers.get(e);if(i){var n=i.indexOf(t);n>-1&&i.splice(n,1)}}},{key:"send",value:function(e,t){return this.isReady||"BRIDGE_HANDSHAKE"===e?this.postMessage(e,t):null}},{key:"sendAndWait",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return new Promise(function(r,a){var o=i.send(e,t);if(o){var s=setTimeout(function(){i.pendingMessages.delete(o),a(new Error("Message timeout: ".concat(e)))},n);i.pendingMessages.set(o,{resolve:r,reject:a,timeoutId:s})}else a(new Error("Failed to send message"))})}},{key:"batchSend",value:function(e){this.send("BATCH_UPDATE",{messages:e,timestamp:performance.now()})}},{key:"sendInput",value:function(e){this.send("GAME_INPUT",u(u({},e),{},{clientTime:performance.now()}))}},{key:"syncCharacterData",value:function(e){this.send("CHARACTER_SYNC",e)}},{key:"reportBattleResult",value:function(e){this.send("BATTLE_RESULT",u(u({},e),{},{timestamp:Date.now(),performanceMetrics:this.getPerformanceMetrics()}))}},{key:"routeMessage",value:function(e){if("BRIDGE_READY"===e.type)return this.isReady=!0,void this.onBridgeReady();if(e.id&&this.pendingMessages.has(e.id)){var t=this.pendingMessages.get(e.id);return clearTimeout(t.timeoutId),t.resolve(e.data),void this.pendingMessages.delete(e.id)}var i=this.messageHandlers.get(e.type);i&&i.forEach(function(t){try{t(e.data)}catch(e){}})}},{key:"onBridgeReady",value:function(){this.send("GAME_READY",{engine:"Phaser",version:Phaser.VERSION,capabilities:this.getGameCapabilities()})}},{key:"getGameCapabilities",value:function(){return{maxFPS:60,inputLatency:"<50ms",supportedFeatures:["touch_controls","haptic_feedback","real_time_sync","offline_mode","asset_streaming"]}}},{key:"updateLatencyMetrics",value:function(e){this.performanceMetrics.messageCount++,this.performanceMetrics.avgLatency=(this.performanceMetrics.avgLatency*(this.performanceMetrics.messageCount-1)+e)/this.performanceMetrics.messageCount}},{key:"getPerformanceMetrics",value:function(){return u(u({},this.performanceMetrics),{},{fps:this.game?this.game.loop.actualFps:0,drawCalls:this.game?this.game.renderer.drawCount:0})}},{key:"attachGame",value:function(e){this.game=e}},{key:"destroy",value:function(){this.messageHandlers.clear(),this.pendingMessages.clear(),window.removeEventListener("message",this.setupMessageListener)}}],t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}());function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}function v(e,t,i){return t=b(t),function(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,i||[],b(e).constructor):t.apply(e,i))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}var w=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,e,[{key:"BootScene"}])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(e,Phaser.Scene),t=e,(i=[{key:"preload",value:function(){this.createLoadingBar(),this.load.image("logo","assets/ui/logo.png"),this.load.json("gameConfig","assets/config/game.json")}},{key:"create",value:function(){this.configureGame(),this.setupInput(),p.send("BOOT_COMPLETE",{timestamp:Date.now()}),this.scene.start("PreloadScene")}},{key:"createLoadingBar",value:function(){var e=this.cameras.main.width,t=this.cameras.main.height;this.add.rectangle(e/2,t/2,e,t,0);var i=400,n=e/2-200,r=t/2;this.add.rectangle(e/2,r,404,24,16777215),this.add.rectangle(e/2,r,i,20,0);var a=this.add.rectangle(n,r,0,16,65280);a.setOrigin(0,.5);var o=this.add.text(e/2,r+40,"Initializing...",{font:"20px Arial",fill:"#ffffff"});o.setOrigin(.5,.5),this.load.on("progress",function(e){a.width=396*e}),this.load.on("fileprogress",function(e){o.setText("Loading: ".concat(e.key))})}},{key:"configureGame",value:function(){this.physics.world.setFPS(60),this.game.renderer.type===Phaser.WEBGL&&this.game.renderer.setBlendMode(Phaser.BlendModes.NORMAL),this.sound.context&&"suspended"===this.sound.context.state&&this.sound.context.resume()}},{key:"setupInput",value:function(){this.input.addPointer(1),this.input.touch.capture=!0,window.ReactNativeWebView||this.input.keyboard.addCapture("W,A,S,D,J,K,L,U,I,O")}}])&&y(t.prototype,i),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a,o,s=[],c=!0,u=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=a.call(i)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return M(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:t+""}var A=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.loadedAssets=new Map,this.textureAtlases=new Map,this.audioBuffers=new Map,this.loadProgress=0,this.priorityQueue=[],this.isLoading=!1,this.maxTextureMemory=104857600,this.currentTextureMemory=0,this.loadTimes=new Map,this.setupLoadHandlers()},t=[{key:"setupLoadHandlers",value:function(){var e=this;this.scene.load.on("progress",function(t){e.loadProgress=t,p.send("ASSET_LOAD_PROGRESS",{progress:t,phase:e.currentLoadPhase})}),this.scene.load.on("complete",function(){e.onLoadComplete()}),this.scene.load.on("loaderror",function(e){p.send("ASSET_LOAD_ERROR",{asset:e.key,type:e.type})})}},{key:"loadAssets",value:function(e){this.currentLoadPhase="initial";var t=this.prioritizeAssets(e);this.loadCriticalAssets(t.critical),this.priorityQueue=[].concat(x(t.high),x(t.medium),x(t.low)),this.scene.load.start()}},{key:"prioritizeAssets",value:function(e){return{critical:e.filter(function(e){return"critical"===e.priority}),high:e.filter(function(e){return"high"===e.priority}),medium:e.filter(function(e){return"medium"===e.priority}),low:e.filter(function(e){return"low"===e.priority||!e.priority})}}},{key:"loadCriticalAssets",value:function(e){var t=this;e.forEach(function(e){var i=performance.now();switch(e.type){case"atlas":t.loadTextureAtlas(e);break;case"sprite":t.loadSprite(e);break;case"audio":t.loadAudio(e);break;case"json":t.loadJSON(e)}t.loadTimes.set(e.key,performance.now()-i)})}},{key:"loadTextureAtlas",value:function(e){var t=this;this.scene.load.atlas(e.key,e.texture,e.atlas,{crossOrigin:"anonymous",onProgress:function(i,n){t.updateAssetProgress(e.key,i/n)}})}},{key:"loadSprite",value:function(e){e.frameConfig?this.scene.load.spritesheet(e.key,e.url,e.frameConfig):this.scene.load.image(e.key,e.url)}},{key:"loadAudio",value:function(e){var t={instances:e.instances||1,context:this.scene.sound.context};Array.isArray(e.url)?this.scene.load.audio(e.key,e.url,t):this.scene.load.audio(e.key,[e.url],t)}},{key:"loadJSON",value:function(e){this.scene.load.json(e.key,e.url)}},{key:"loadNextBatch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.isLoading||0===this.priorityQueue.length||(this.isLoading=!0,this.currentLoadPhase="progressive",this.priorityQueue.splice(0,t).forEach(function(t){return e.loadAsset(t)}),this.scene.load.start())}},{key:"loadAsset",value:function(e){switch("atlas"!==e.type&&"sprite"!==e.type||this.canLoadTexture(e.estimatedSize)||this.performMemoryCleanup(),e.type){case"atlas":this.loadTextureAtlas(e);break;case"sprite":this.loadSprite(e);break;case"audio":this.loadAudio(e);break;case"json":this.loadJSON(e)}}},{key:"canLoadTexture",value:function(e){return this.currentTextureMemory+e<this.maxTextureMemory}},{key:"performMemoryCleanup",value:function(){var e,t=Array.from(this.loadedAssets.entries()).filter(function(e){var t=P(e,2);return t[0],"texture"===t[1].type}).sort(function(e,t){return e[1].lastUsed-t[1].lastUsed}),i=0,n=.2*this.maxTextureMemory,r=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=O(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}(t);try{for(r.s();!(e=r.n()).done;){var a=P(e.value,2),o=a[0],s=a[1];if(i>=n)break;s.critical||(this.unloadAsset(o),i+=s.size)}}catch(e){r.e(e)}finally{r.f()}p.send("MEMORY_CLEANUP",{freed:i,current:this.currentTextureMemory})}},{key:"unloadAsset",value:function(e){var t=this.loadedAssets.get(e);if(t){switch(t.type){case"texture":case"atlas":this.scene.textures.remove(e),this.currentTextureMemory-=t.size;break;case"audio":this.scene.cache.audio.remove(e)}this.loadedAssets.delete(e)}}},{key:"loadCharacterSprites",value:function(e){var t=[];e.evolutionStages.forEach(function(i,n){t.push({key:"".concat(e.id,"_stage_").concat(n),type:"atlas",texture:i.texture,atlas:i.atlas,priority:n===e.currentStage?"critical":"high",estimatedSize:i.size||2097152})}),this.loadAssets(t)}},{key:"loadCombatAssets",value:function(e){var t=[{key:"stage_".concat(e.stageId),type:"sprite",url:"assets/stages/".concat(e.stageId,"/background.png"),priority:"critical"},{key:"boss_".concat(e.bossId),type:"atlas",texture:"assets/bosses/".concat(e.bossId,"/sprites.png"),atlas:"assets/bosses/".concat(e.bossId,"/sprites.json"),priority:"critical"},{key:"hit_sounds",type:"audio",url:["assets/audio/combat/hits.ogg","assets/audio/combat/hits.mp3"],priority:"high"}];this.loadAssets(t)}},{key:"getAsset",value:function(e){var t=this.loadedAssets.get(e);return t?(t.lastUsed=Date.now(),t.data):null}},{key:"onLoadComplete",value:function(){var e=this;this.isLoading=!1,p.send("ASSETS_LOADED",{phase:this.currentLoadPhase,loadedCount:this.loadedAssets.size,memoryUsage:this.currentTextureMemory,loadTimes:Object.fromEntries(this.loadTimes)}),this.priorityQueue.length>0&&setTimeout(function(){return e.loadNextBatch()},100)}},{key:"updateAssetProgress",value:function(e,t){p.send("ASSET_PROGRESS",{asset:e,progress:t})}},{key:"getPerformanceStats",value:function(){return{totalAssets:this.loadedAssets.size,textureMemory:this.currentTextureMemory,avgLoadTime:this.calculateAverageLoadTime(),cacheHitRate:this.calculateCacheHitRate()}}},{key:"calculateAverageLoadTime",value:function(){return 0===this.loadTimes.size?0:Array.from(this.loadTimes.values()).reduce(function(e,t){return e+t},0)/this.loadTimes.size}},{key:"calculateCacheHitRate",value:function(){return.85}},{key:"destroy",value:function(){this.loadedAssets.clear(),this.textureAtlases.clear(),this.audioBuffers.clear(),this.priorityQueue=[]}}],t&&_(e.prototype,t),i&&_(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),D=[{key:"ui_atlas",type:"atlas",texture:"assets/ui/ui_sprites.png",atlas:"assets/ui/ui_sprites.json",priority:"critical"},{key:"character_base",type:"atlas",texture:"assets/characters/base/sprites.png",atlas:"assets/characters/base/sprites.json",priority:"critical"}];function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function B(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}function E(e,t,i){return t=R(t),function(e,t){if(t&&("object"==C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,j()?Reflect.construct(t,i||[],R(e).constructor):t.apply(e,i))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(j=function(){return!!e})()}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}var L=function(){function e(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=E(this,e,[{key:"PreloadScene"}])).assetManager=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(e,Phaser.Scene),t=e,(i=[{key:"init",value:function(e){this.initData=e||{}}},{key:"preload",value:function(){this.assetManager=new A(this),this.createLoadingUI(),this.assetManager.loadAssets(D),this.initData.characterData&&this.assetManager.loadCharacterSprites(this.initData.characterData)}},{key:"create",value:function(){this.prepareGameSystems(),p.send("PRELOAD_COMPLETE",{assetsLoaded:this.assetManager.loadedAssets.size,timestamp:Date.now()}),this.initData.startBattle?this.scene.start("BattleScene",this.initData.battleData):this.waitForBattleCommand()}},{key:"createLoadingUI",value:function(){var e=this.cameras.main.width,t=this.cameras.main.height;this.add.rectangle(e/2,t/2,e,t,1710618),this.textures.exists("logo")&&this.add.image(e/2,t/2-100,"logo").setScale(.5);var i=600,n=e/2-300,r=t/2+50;this.add.rectangle(e/2,r,604,34,4473924),this.add.rectangle(e/2,r,i,30,2236962);var a=this.add.rectangle(n,r,0,26,65280);a.setOrigin(0,.5);var o=this.add.text(e/2,r+50,"Loading Assets...",{font:"24px Arial",fill:"#ffffff"});o.setOrigin(.5,.5);var s=this.add.text(e/2,r-50,"0%",{font:"32px Arial",fill:"#ffffff"});s.setOrigin(.5,.5);var c=this.add.text(e/2,r+80,"",{font:"16px Arial",fill:"#aaaaaa"});c.setOrigin(.5,.5),this.load.on("progress",function(e){a.width=596*e,s.setText("".concat(Math.round(100*e),"%"))}),this.load.on("fileprogress",function(e){c.setText("Loading: ".concat(e.key))}),this.load.on("complete",function(){o.setText("Ready!"),c.setText("")})}},{key:"prepareGameSystems",value:function(){this.createAnimations(),this.prepareSoundPools(),this.prepareParticleSystems()}},{key:"createAnimations",value:function(){this.textures.exists("ui_atlas")&&(this.anims.create({key:"hit_spark",frames:this.anims.generateFrameNames("ui_atlas",{prefix:"hit_spark_",start:0,end:5,zeroPad:2}),frameRate:60,repeat:0}),this.anims.create({key:"block_spark",frames:this.anims.generateFrameNames("ui_atlas",{prefix:"block_spark_",start:0,end:3,zeroPad:2}),frameRate:30,repeat:0}))}},{key:"prepareSoundPools",value:function(){var e=this;[{key:"hit_light",count:3},{key:"hit_medium",count:3},{key:"hit_heavy",count:2},{key:"block",count:2},{key:"special_activate",count:1}].forEach(function(t){if(e.cache.audio.exists(t.key))for(var i=0;i<t.count;i++)e.sound.add(t.key,{volume:0})})}},{key:"prepareParticleSystems",value:function(){}},{key:"waitForBattleCommand",value:function(){var e=this,t=this.cameras.main.width,i=this.cameras.main.height,n=this.add.text(t/2,i/2+150,"Touch to Continue",{font:"28px Arial",fill:"#ffffff"});n.setOrigin(.5,.5),this.tweens.add({targets:n,alpha:.5,duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.input.once("pointerdown",function(){p.send("READY_FOR_BATTLE",{timestamp:Date.now()})}),p.on("START_BATTLE",function(t){e.scene.start("BattleScene",t)})}}])&&B(t.prototype,i),n&&B(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a,o,s=[],c=!0,u=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=a.call(i)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function G(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U(n.key),n)}}function U(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:t+""}var K=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.frameData=new Map,this.inputBufferSize=30,this.inputHistoryP1=[],this.inputHistoryP2=[],this.comboWindowFrames=15,this.comboCounts={p1:0,p2:0},this.comboTimers={p1:0,p2:0},this.damageScaling=[1,.9,.8,.7,.6,.5,.4,.3,.3,.3],this.superMeterMax=100,this.superMeters={p1:0,p2:0},this.stunTimers={p1:0,p2:0},this.initializeFrameData(),this.specialMovePatterns=this.initializeSpecialMoves()},(t=[{key:"initializeFrameData",value:function(){this.frameData.set("LP",{startup:3,active:3,recovery:7,damage:20,hitstun:12,blockstun:8,pushback:2,cancelable:!0,specialCancelable:!0,superCancelable:!0,hitbox:{x:50,y:-20,width:60,height:40},hurtbox:{x:0,y:0,width:80,height:150}}),this.frameData.set("MP",{startup:5,active:4,recovery:10,damage:30,hitstun:16,blockstun:12,pushback:3,cancelable:!0,specialCancelable:!0,superCancelable:!0,hitbox:{x:60,y:-20,width:70,height:45},hurtbox:{x:0,y:0,width:85,height:150}}),this.frameData.set("HP",{startup:8,active:5,recovery:18,damage:45,hitstun:22,blockstun:18,pushback:5,cancelable:!1,specialCancelable:!0,superCancelable:!0,hitbox:{x:70,y:-20,width:80,height:50},hurtbox:{x:0,y:0,width:90,height:150}}),this.frameData.set("LK",{startup:4,active:3,recovery:8,damage:18,hitstun:12,blockstun:8,pushback:2,cancelable:!0,specialCancelable:!0,superCancelable:!0,hitbox:{x:55,y:20,width:65,height:50},hurtbox:{x:0,y:0,width:80,height:150}}),this.frameData.set("MK",{startup:6,active:4,recovery:12,damage:28,hitstun:16,blockstun:12,pushback:4,cancelable:!0,specialCancelable:!0,superCancelable:!0,hitbox:{x:65,y:10,width:75,height:60},hurtbox:{x:0,y:0,width:85,height:150}}),this.frameData.set("HK",{startup:10,active:6,recovery:20,damage:40,hitstun:24,blockstun:20,pushback:6,cancelable:!1,specialCancelable:!1,superCancelable:!0,hitbox:{x:75,y:0,width:85,height:70},hurtbox:{x:0,y:0,width:90,height:150}}),this.frameData.set("CR_LP",{startup:3,active:3,recovery:6,damage:18,hitstun:12,blockstun:8,pushback:1,cancelable:!0,specialCancelable:!0,superCancelable:!0,hitbox:{x:45,y:40,width:55,height:30},hurtbox:{x:0,y:25,width:80,height:100}}),this.frameData.set("CR_MK",{startup:7,active:5,recovery:14,damage:25,hitstun:18,blockstun:14,pushback:4,cancelable:!1,specialCancelable:!0,superCancelable:!0,low:!0,hitbox:{x:70,y:70,width:80,height:20},hurtbox:{x:0,y:25,width:80,height:100}}),this.frameData.set("J_HP",{startup:6,active:8,recovery:4,damage:40,hitstun:20,blockstun:16,pushback:3,cancelable:!1,specialCancelable:!1,superCancelable:!1,overhead:!0,hitbox:{x:30,y:20,width:70,height:60},hurtbox:{x:0,y:0,width:80,height:150}}),this.frameData.set("HADOUKEN",{startup:13,active:999,recovery:40,damage:30,hitstun:18,blockstun:14,pushback:4,cancelable:!1,specialCancelable:!1,superCancelable:!0,projectile:!0,projectileSpeed:8,hitbox:{x:0,y:0,width:50,height:50}}),this.frameData.set("SHORYUKEN",{startup:3,active:14,recovery:24,damage:60,hitstun:30,blockstun:0,pushback:0,cancelable:!1,specialCancelable:!1,superCancelable:!1,invincible:{start:1,end:6},hitbox:{x:40,y:-60,width:60,height:120},hurtbox:{x:0,y:0,width:80,height:150}}),this.frameData.set("THROW",{startup:5,active:2,recovery:24,damage:40,hitstun:60,blockstun:0,pushback:0,cancelable:!1,specialCancelable:!1,superCancelable:!1,throw:!0,range:80,hitbox:{x:50,y:0,width:80,height:100}}),this.frameData.set("SUPER_HADOUKEN",{startup:10,active:999,recovery:50,damage:80,hitstun:40,blockstun:30,pushback:8,cancelable:!1,specialCancelable:!1,superCancelable:!1,projectile:!0,projectileSpeed:12,meterCost:100,hitbox:{x:0,y:0,width:100,height:80},hits:5})}},{key:"initializeSpecialMoves",value:function(){return{QCF_P:{pattern:["DOWN","DOWN_FORWARD","FORWARD"],buttons:["LP","MP","HP"],move:"HADOUKEN",window:10},DP_P:{pattern:["FORWARD","DOWN","DOWN_FORWARD"],buttons:["LP","MP","HP"],move:"SHORYUKEN",window:10},QCB_K:{pattern:["DOWN","DOWN_BACK","BACK"],buttons:["LK","MK","HK"],move:"TATSUMAKI",window:10},CHARGE_B_F_P:{pattern:["CHARGE_BACK","FORWARD"],buttons:["LP","MP","HP"],move:"SONIC_BOOM",window:8,chargeTime:60},SPD:{pattern:["FORWARD","DOWN_FORWARD","DOWN","DOWN_BACK","BACK","UP_BACK","UP","UP_FORWARD"],buttons:["LP","MP","HP"],move:"SPD",window:15,isCommand:!0},SUPER_QCF_P:{pattern:["DOWN","DOWN_FORWARD","FORWARD","DOWN","DOWN_FORWARD","FORWARD"],buttons:["LP","MP","HP"],move:"SUPER_HADOUKEN",window:20,requiresMeter:!0}}}},{key:"processInput",value:function(e,t){var i="p1"===e?this.inputHistoryP1:this.inputHistoryP2;i.push({input:t,frame:this.scene.game.loop.frame,timestamp:performance.now()}),i.length>this.inputBufferSize&&i.shift();var n=this.checkSpecialMoves(e,i);return n||t}},{key:"checkSpecialMoves",value:function(e,t){if(t.length<2)return null;for(var i=this.scene.game.loop.frame,n=0,r=Object.entries(this.specialMovePatterns);n<r.length;n++){var a=N(r[n],2),o=(a[0],a[1]),s=t[t.length-1];if(o.buttons.includes(s.input)&&!(o.requiresMeter&&this.superMeters[e]<this.superMeterMax)){if(o.chargeTime){if(!this.checkChargeMove(e,t,o))continue}else if(!this.checkMotionInputs(t,o,i))continue;return o.requiresMeter&&(this.superMeters[e]=0),o.move}}return null}},{key:"checkMotionInputs",value:function(e,t,i){for(var n=t.pattern,r=t.window,a=0,o=null,s=e.length-2;s>=0;s--){var c=e[s];if(o&&i-c.frame>r)break;if(c.input===n[a]&&(0===a&&(o=c.frame),++a>=n.length))return!0}return!1}},{key:"checkChargeMove",value:function(e,t,i){for(var n,r=null,a=this.scene.game.loop.frame,o=t.length-1;o>=0;o--){var s=t[o];if(s.input===i.pattern[0])r=s.frame;else if(r&&s.input!==i.pattern[0])break}return!!(r&&a-r>=i.chargeTime&&(null===(n=t[t.length-2])||void 0===n?void 0:n.input)===i.pattern[1])}},{key:"createHitbox",value:function(e,t,i){var n=this.frameData.get(t);if(!n)return null;var r={attacker:e,move:t,moveData:n,x:e.x+("right"===i?n.hitbox.x:-n.hitbox.x),y:e.y+n.hitbox.y,width:n.hitbox.width,height:n.hitbox.height,active:!0,currentFrame:0,facing:i};return n.projectile&&(r.velocity="right"===i?n.projectileSpeed:-n.projectileSpeed,r.lifetime=120),r}},{key:"checkHit",value:function(e,t,i){if(t.invincibleFrames>0)return null;if(!this.checkBoxOverlap(e.x,e.y,e.width,e.height,i.x,i.y,i.width,i.height))return null;var n=this.checkBlocking(t,e);return{hit:!0,blocked:n,damage:this.calculateDamage(e,t,n),hitstun:n?e.moveData.blockstun:e.moveData.hitstun,pushback:e.moveData.pushback,juggle:t.airborne&&!n,launcher:e.moveData.launcher||!1}}},{key:"checkBoxOverlap",value:function(e,t,i,n,r,a,o,s){return!(e+i<r||r+o<e||t+n<a||a+s<t)}},{key:"checkBlocking",value:function(e,t){if(this.stunTimers[e.player]>0)return!1;if(t.moveData.throw)return!1;if(!e.blocking)return!1;var i=t.x>e.x;return!(!(i&&"right"===e.facing||!i&&"left"===e.facing)||t.moveData.low&&!e.crouching||t.moveData.overhead&&e.crouching)}},{key:"calculateDamage",value:function(e,t,i){var n=e.moveData.damage;i&&(n*=.1);var r=this.comboCounts[e.attacker.player];return r>0&&r<this.damageScaling.length&&(n*=this.damageScaling[r]),n*=1-(t.defense||0),Math.floor(n)}},{key:"applyHit",value:function(e,t,i){var n=t.player,r=i.player;i.health=Math.max(0,i.health-e.damage),this.stunTimers[r]=e.hitstun,i.state=e.blocked?"blockstun":"hitstun";var a=t.x<i.x?1:-1;i.velocity.x=a*e.pushback*10,e.juggle&&(i.juggleCount=(i.juggleCount||0)+1,i.velocity.y=-8),e.blocked||(this.comboCounts[n]++,this.comboTimers[n]=this.comboWindowFrames,this.superMeters[n]=Math.min(this.superMeterMax,this.superMeters[n]+.5*e.damage)),this.superMeters[r]=Math.min(this.superMeterMax,this.superMeters[r]+.3*e.damage)}},{key:"update",value:function(){for(var e=0,t=["p1","p2"];e<t.length;e++){var i=t[e];this.stunTimers[i]>0&&this.stunTimers[i]--,this.comboTimers[i]>0&&(this.comboTimers[i]--,0===this.comboTimers[i]&&(this.comboCounts[i]=0))}}},{key:"canCancel",value:function(e,t,i){var n=this.frameData.get(e),r=this.frameData.get(t);return!(!n||!r)&&(r.projectile||r.invincible?n.specialCancelable:r.meterCost?n.superCancelable:n.cancelable)}},{key:"getFrameAdvantage",value:function(e,t,i,n){var r=this.frameData.get(i);if(!r)return 0;var a=r.recovery;return(n?r.blockstun:r.hitstun)-a}},{key:"reset",value:function(){this.inputHistoryP1=[],this.inputHistoryP2=[],this.comboCounts={p1:0,p2:0},this.comboTimers={p1:0,p2:0},this.stunTimers={p1:0,p2:0},this.superMeters={p1:0,p2:0}}}])&&G(e.prototype,t),i&&G(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a,o,s=[],c=!0,u=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=a.call(i)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(e,t)||Y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Y(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function Y(e,t){if(e){if("string"==typeof e)return X(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function J(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z(n.key),n)}}function Z(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:t+""}var q=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.combatSystem=i,this.currentBoss=null,this.aiState="neutral",this.stateTimer=0,this.lastAction=null,this.actionCooldown=0,this.reactionTime=10,this.decisionBuffer=[],this.playerPatterns=new Map,this.adaptationLevel=0,this.bossPatterns=this.initializeBossPatterns()},t=[{key:"initializeBossPatterns",value:function(){return{glass_joe:{name:"Glass Joe",difficulty:1,health:80,defense:.8,reactionTime:20,aggressiveness:.2,patterns:{neutral:{actions:[{move:"walk_back",weight:40},{move:"walk_forward",weight:20},{move:"LP",weight:20},{move:"block",weight:20}]},offensive:{actions:[{move:"LP",weight:40},{move:"MP",weight:20},{move:"LK",weight:20},{move:"walk_forward",weight:20}]},defensive:{actions:[{move:"block",weight:60},{move:"walk_back",weight:30},{move:"LP",weight:10}]}},combos:[["LP","LP"],["LP","MP"]],specialTriggers:{lowHealth:.3,panicMoves:["block","walk_back"]}},bald_bull:{name:"Bald Bull",difficulty:2,health:100,defense:.9,reactionTime:15,aggressiveness:.7,patterns:{neutral:{actions:[{move:"walk_forward",weight:50},{move:"dash_forward",weight:20},{move:"MP",weight:20},{move:"block",weight:10}]},offensive:{actions:[{move:"HP",weight:30},{move:"MP",weight:30},{move:"bull_charge",weight:20},{move:"throw",weight:20}]},defensive:{actions:[{move:"HP",weight:40},{move:"bull_charge",weight:30},{move:"block",weight:30}]}},combos:[["MP","MP","HP"],["LP","MP","bull_charge"],["throw"]],specialMoves:{bull_charge:{startup:30,pattern:["CHARGE_BACK","FORWARD","HP"],damage:60,condition:function(e){return e>200}}}},piston_honda:{name:"Piston Honda",difficulty:3,health:100,defense:1,reactionTime:12,aggressiveness:.5,patterns:{neutral:{actions:[{move:"walk_forward",weight:30},{move:"walk_back",weight:20},{move:"MP",weight:25},{move:"MK",weight:25}]},offensive:{actions:[{move:"rush_punch",weight:30},{move:"MP",weight:25},{move:"HP",weight:25},{move:"HK",weight:20}]},defensive:{actions:[{move:"block",weight:40},{move:"counter_punch",weight:30},{move:"backdash",weight:30}]},punish:{actions:[{move:"HP",weight:50},{move:"rush_punch",weight:50}]}},combos:[["MP","MP","HP"],["LK","MK","HK"],["MP","HADOUKEN"]],specialMoves:{rush_punch:{pattern:["MP","MP","MP","MP"],damage:40,hits:4}},adaptiveBehavior:!0},great_tiger:{name:"Great Tiger",difficulty:4,health:90,defense:.9,reactionTime:10,aggressiveness:.4,patterns:{neutral:{actions:[{move:"walk_back",weight:30},{move:"tiger_shot",weight:30},{move:"MP",weight:20},{move:"teleport",weight:20}]},offensive:{actions:[{move:"teleport_attack",weight:40},{move:"tiger_uppercut",weight:30},{move:"MP",weight:30}]},defensive:{actions:[{move:"teleport_away",weight:50},{move:"block",weight:30},{move:"tiger_shot",weight:20}]},zoning:{actions:[{move:"tiger_shot",weight:60},{move:"walk_back",weight:30},{move:"jump_back",weight:10}]}},combos:[["teleport","HP"],["tiger_shot","tiger_shot"],["MP","tiger_uppercut"]],specialMoves:{tiger_shot:{pattern:["QCF","P"],projectile:!0,damage:25},tiger_uppercut:{pattern:["DP","P"],damage:50,invincible:!0},teleport:{startup:20,recovery:10,invincible:!0}},teleportLogic:{behind:.6,away:.4}},super_macho_man:{name:"Super Macho Man",difficulty:5,health:120,defense:1.1,reactionTime:8,aggressiveness:.6,patterns:{neutral:{actions:[{move:"walk_forward",weight:40},{move:"HP",weight:30},{move:"super_spin",weight:20},{move:"taunt",weight:10}]},offensive:{actions:[{move:"super_spin",weight:35},{move:"clothesline",weight:35},{move:"HP",weight:30}]},defensive:{actions:[{move:"armored_punch",weight:40},{move:"block",weight:30},{move:"super_spin",weight:30}]},rage:{actions:[{move:"rage_rush",weight:50},{move:"super_spin",weight:30},{move:"clothesline",weight:20}]}},combos:[["HP","HP","super_spin"],["MP","HP","clothesline"],["taunt","rage_rush"]],specialMoves:{super_spin:{pattern:["HCF","P"],damage:45,hits:3,armor:!0},clothesline:{pattern:["CHARGE_BACK","FORWARD","HP"],damage:55,wallBounce:!0},rage_rush:{trigger:"lowHealth",damage:80,hits:5,superArmor:!0}},armorFrames:{HP:[5,15],super_spin:[1,20]}},mike_bison:{name:"Mike Bison",difficulty:6,health:150,defense:1.2,reactionTime:5,aggressiveness:.8,patterns:{neutral:{actions:[{move:"psycho_crusher",weight:30},{move:"scissor_kick",weight:30},{move:"HP",weight:20},{move:"walk_forward",weight:20}]},offensive:{actions:[{move:"psycho_crusher",weight:30},{move:"scissor_kick",weight:25},{move:"knee_press",weight:25},{move:"throw",weight:20}]},defensive:{actions:[{move:"psycho_reflect",weight:40},{move:"teleport_dash",weight:30},{move:"block",weight:30}]},desperation:{actions:[{move:"final_psycho_crusher",weight:50},{move:"psycho_punisher",weight:30},{move:"rage_combo",weight:20}]}},combos:[["MP","HP","scissor_kick"],["psycho_crusher","HP","knee_press"],["throw","psycho_crusher"],["MP","MP","HP","psycho_punisher"]],specialMoves:{psycho_crusher:{pattern:["CHARGE_BACK","FORWARD","P"],damage:50,projectileInvincible:!0,chipDamage:10},scissor_kick:{pattern:["CHARGE_BACK","FORWARD","K"],damage:40,overhead:!0},psycho_punisher:{pattern:["QCF","QCF","P"],damage:100,hits:7,meterCost:100,invincibleStartup:!0},final_psycho_crusher:{trigger:"desperation",damage:120,fullScreenTracking:!0,unblockable:!1}},readInputs:!0,perfectBlocking:.7,counterHitSetups:!0}}}},{key:"setBoss",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this.currentBoss=this.bossPatterns[e],this.currentBoss&&(this.adjustDifficulty(t),this.reset())}},{key:"adjustDifficulty",value:function(e){var t={easy:{reaction:1.5,aggression:.7,defense:.8},normal:{reaction:1,aggression:1,defense:1},hard:{reaction:.7,aggression:1.3,defense:1.2},nightmare:{reaction:.5,aggression:1.5,defense:1.5}},i=t[e]||t.normal;this.currentBoss.reactionTime=Math.floor(this.currentBoss.reactionTime*i.reaction),this.currentBoss.aggressiveness*=i.aggression,this.currentBoss.defense*=i.defense}},{key:"update",value:function(e,t,i){if(!this.currentBoss||this.actionCooldown>0)return this.actionCooldown--,null;var n=this.analyzeSituation(e,t,i);this.updateAIState(n);var r=this.makeDecision(n);return r&&this.decisionBuffer.push({action:r,executeFrame:i.currentFrame+this.currentBoss.reactionTime}),this.executeBufferedDecisions(i.currentFrame)}},{key:"analyzeSituation",value:function(e,t,i){var n=Math.abs(e.x-t.x);return{distance:n,heightDiff:e.y-t.y,playerAirborne:0!==t.velocity.y,bossAirborne:0!==e.velocity.y,playerStunned:this.combatSystem.stunTimers.p1>0,bossStunned:this.combatSystem.stunTimers.p2>0,playerBlocking:t.blocking,playerAttacking:"attacking"===t.state,bossHealth:e.health,playerHealth:t.health,bossHealthPercent:e.health/this.currentBoss.health,playerHealthPercent:t.health/100,bossMetar:this.combatSystem.superMeters.p2,playerMeter:this.combatSystem.superMeters.p1,range:this.getRange(n),playerLastMove:this.getPlayerLastMove(),comboOpportunity:this.checkComboOpportunity(e,t)}}},{key:"getRange",value:function(e){return e<80?"throw":e<150?"close":e<300?"mid":e<500?"far":"fullscreen"}},{key:"updateAIState",value:function(e){var t=this.currentBoss;t.specialTriggers&&e.bossHealthPercent<=t.specialTriggers.lowHealth?this.aiState="desperation":e.playerStunned||e.comboOpportunity?this.aiState="punish":(e.playerAttacking||e.bossHealthPercent<.3)&&Math.random()<.5?this.aiState="defensive":t.patterns.zoning&&"far"===e.range?this.aiState="zoning":Math.random()<t.aggressiveness?this.aiState="offensive":this.aiState="neutral"}},{key:"makeDecision",value:function(e){var t=this.currentBoss.patterns[this.aiState];if(!t)return null;if("punish"===this.aiState&&e.comboOpportunity)return this.selectCombo(e);var i,n=t.actions,r=n.reduce(function(e,t){return e+t.weight},0),a=Math.random()*r,o=V(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;if((a-=s.weight)<=0)return this.processAction(s.move,e)}}catch(e){o.e(e)}finally{o.f()}return null}},{key:"selectCombo",value:function(e){var t=this,i=this.currentBoss.combos;if(!i||0===i.length)return"HP";var n=i;return"far"===e.range&&(n=i.filter(function(e){return e.some(function(e){return t.isProjectile(e)})})),n.length>0?n[Math.floor(Math.random()*n.length)][0]:"MP"}},{key:"processAction",value:function(e,t){if(this.currentBoss.specialMoves&&this.currentBoss.specialMoves[e]){var i=this.currentBoss.specialMoves[e];return i.condition&&!i.condition(t.distance)||i.meterCost&&this.combatSystem.superMeters.p2<i.meterCost?null:e}switch(e){case"walk_forward":return t.distance>150?"MOVE_RIGHT":null;case"walk_back":return t.distance<200?"MOVE_LEFT":null;case"jump":return"JUMP";case"block":return"BLOCK";default:return e}}},{key:"executeBufferedDecisions",value:function(e){if(0===this.decisionBuffer.length)return null;var t=this.decisionBuffer[0];return e>=t.executeFrame?(this.decisionBuffer.shift(),this.lastAction=t.action,this.actionCooldown=10,t.action):null}},{key:"checkComboOpportunity",value:function(e,t){return this.combatSystem.stunTimers.p1>5||"recovery"===t.state||!!t.whiffedAttack}},{key:"getPlayerLastMove",value:function(){var e=this.combatSystem.inputHistoryP1;return e.length>0?e[e.length-1].input:null}},{key:"isProjectile",value:function(e){var t=this.combatSystem.frameData.get(e);return t&&t.projectile}},{key:"trackPlayerPattern",value:function(e){if(this.currentBoss.adaptiveBehavior){var t=this.playerPatterns.get(e)||{count:0,situations:[]};t.count++,t.situations.push({aiState:this.aiState,timestamp:performance.now()}),this.playerPatterns.set(e,t),this.adaptationLevel=Math.min(1,this.adaptationLevel+.01)}}},{key:"predictPlayerAction",value:function(){if(this.adaptationLevel<.3)return null;var e,t=null,i=0,n=V(this.playerPatterns);try{for(n.s();!(e=n.n()).done;){var r=Q(e.value,2),a=r[0],o=r[1].situations.filter(function(e){return performance.now()-e.timestamp<3e4}).length;o>i&&(i=o,t=a)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"reset",value:function(){this.aiState="neutral",this.stateTimer=0,this.lastAction=null,this.actionCooldown=0,this.decisionBuffer=[],this.playerPatterns.clear(),this.adaptationLevel=0}}],t&&J(e.prototype,t),i&&J(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function ee(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function te(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(i),!0).forEach(function(t){ie(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ee(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function ie(e,t,i){return(t=re(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ne(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,re(n.key),n)}}function re(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}function ae(e,t,i){return t=se(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,oe()?Reflect.construct(t,i||[],se(e).constructor):t.apply(e,i))}function oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(oe=function(){return!!e})()}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}function ce(e,t){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ce(e,t)}var ue=function(){function e(t,i,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(a=ae(this,e,[t,i,n])).scene=t,a.config=r,a.player=r.player||"p1",a.characterId=r.characterId,a.isAI=r.isAI||!1,a.maxHealth=r.maxHealth||100,a.health=a.maxHealth,a.attack=r.attack||1,a.defense=r.defense||0,a.speed=r.speed||1,a.state="idle",a.facing=r.facing||"right",a.grounded=!0,a.airborne=!1,a.crouching=!1,a.blocking=!1,a.currentMove=null,a.moveFrame=0,a.invincibleFrames=0,a.armorFrames=0,a.juggleCount=0,a.comboCounts=0,a.velocity={x:0,y:0},a.gravity=.8,a.friction=.85,a.maxVelocity={x:10*a.speed,y:20},a.createVisuals(),a.hurtbox=a.createHurtbox(),a.hitboxes=[],a.animationLocked=!1,a.inputBuffer=[],a.bufferWindow=10,t.add.existing(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}(e,Phaser.GameObjects.Container),t=e,(i=[{key:"createVisuals",value:function(){var e;this.sprite=this.scene.add.sprite(0,0,this.config.texture),this.add(this.sprite),this.shadow=this.scene.add.ellipse(0,80,80,20,0,.3),this.add(this.shadow),this.sendToBack(this.shadow),null!==(e=this.scene.game.config.physics.arcade)&&void 0!==e&&e.debug&&(this.debugGraphics=this.scene.add.graphics(),this.add(this.debugGraphics)),this.setupAnimations()}},{key:"setupAnimations",value:function(){var e=this;["idle","walk_forward","walk_back","crouch","jump","LP","MP","HP","LK","MK","HK","block_stand","block_crouch","hit_stand","hit_crouch","knockdown","getup","victory","defeat"].forEach(function(t){var i="".concat(e.config.texture,"_").concat(t);e.scene.anims.exists(i)||e.scene.anims.create({key:i,frames:e.scene.anims.generateFrameNumbers(e.config.texture,{start:0,end:3}),frameRate:10,repeat:"idle"===t||t.includes("walk")?-1:0})})}},{key:"createHurtbox",value:function(){return{x:0,y:0,width:80,height:150,active:!0}}},{key:"update",value:function(e){this.updatePhysics(e),this.updateCombatState(e),this.updateAnimation(),this.updateVisuals(),this.updateHitboxes(e)}},{key:"updatePhysics",value:function(e){this.grounded||(this.velocity.y+=this.gravity,this.velocity.y=Math.min(this.velocity.y,this.maxVelocity.y)),this.grounded&&"hitstun"!==this.state&&"blockstun"!==this.state&&(this.velocity.x*=this.friction),this.x+=this.velocity.x,this.y+=this.velocity.y,this.y>=this.config.groundY?(this.y=this.config.groundY,this.velocity.y=0,this.grounded=!0,this.airborne=!1,this.juggleCount=0):(this.grounded=!1,this.airborne=!0),this.x=Phaser.Math.Clamp(this.x,100,1820)}},{key:"updateCombatState",value:function(e){if(this.currentMove){this.moveFrame++;var t=this.scene.combatSystem.frameData.get(this.currentMove);if(t){var i=t.startup+t.active+t.recovery;this.moveFrame>=i&&this.endMove()}}this.invincibleFrames>0&&this.invincibleFrames--,this.armorFrames>0&&this.armorFrames--,this.scene.combatSystem.stunTimers[this.player]>0?this.state=this.blocking?"blockstun":"hitstun":"hitstun"!==this.state&&"blockstun"!==this.state||(this.state="idle")}},{key:"updateAnimation",value:function(){var e;if(!this.animationLocked){var t="",i=this.config.texture;switch(this.state){case"idle":t=this.crouching?"crouch":"idle";break;case"walking":t=this.velocity.x*("right"===this.facing?1:-1)>0?"walk_forward":"walk_back";break;case"jumping":t="jump";break;case"attacking":t=this.currentMove||"LP";break;case"blocking":case"blockstun":t=this.crouching?"block_crouch":"block_stand";break;case"hitstun":t=this.crouching?"hit_crouch":"hit_stand";break;case"knockdown":t="knockdown"}var n="".concat(i,"_").concat(t);this.scene.anims.exists(n)&&(null===(e=this.sprite.anims.currentAnim)||void 0===e?void 0:e.key)!==n&&this.sprite.play(n)}}},{key:"updateVisuals",value:function(){this.sprite.setFlipX("left"===this.facing),this.shadow.y=this.config.groundY-this.y+80,this.shadow.scaleX=1-Math.abs(this.y-this.config.groundY)/200,this.shadow.alpha=.3*this.shadow.scaleX,"hitstun"===this.state?this.sprite.setTint(16737894):this.invincibleFrames>0?this.sprite.setAlpha(Math.sin(.5*this.invincibleFrames)>0?1:.5):(this.sprite.clearTint(),this.sprite.setAlpha(1)),this.debugGraphics&&this.drawDebugInfo()}},{key:"updateHitboxes",value:function(e){this.hitboxes=this.hitboxes.filter(function(e){return e.lifetime--,e.lifetime>0})}},{key:"drawDebugInfo",value:function(){var e=this;this.debugGraphics.clear(),this.hurtbox.active&&(this.debugGraphics.lineStyle(2,65280),this.debugGraphics.strokeRect(this.hurtbox.x-this.hurtbox.width/2,this.hurtbox.y-this.hurtbox.height/2,this.hurtbox.width,this.hurtbox.height)),this.hitboxes.forEach(function(t){e.debugGraphics.lineStyle(2,16711680),e.debugGraphics.strokeRect(t.x-t.width/2,t.y-t.height/2,t.width,t.height)})}},{key:"handleInput",value:function(e){var t=this;this.inputBuffer.push({input:e,frame:this.scene.game.loop.frame});var i=this.scene.game.loop.frame;this.inputBuffer=this.inputBuffer.filter(function(e){return i-e.frame<=t.bufferWindow});var n=this.scene.combatSystem.processInput(this.player,e);this.canPerformMove(n)&&this.performMove(n)}},{key:"canPerformMove",value:function(e){if("hitstun"===this.state||"blockstun"===this.state)return!1;if(this.currentMove&&!this.scene.combatSystem.canCancel(this.currentMove,e,this.player))return!1;var t=this.scene.combatSystem.frameData.get(e);if(t){if(t.meterCost&&this.scene.combatSystem.superMeters[this.player]<t.meterCost)return!1;if(t.requiresGrounded&&!this.grounded)return!1;if(t.requiresAirborne&&!this.airborne)return!1}return!0}},{key:"performMove",value:function(e){var t=this;this.currentMove=e,this.moveFrame=0,this.state="attacking",this.animationLocked=!0;var i=this.scene.combatSystem.frameData.get(e);i&&(i.invincible&&(this.invincibleFrames=i.invincible.end-i.invincible.start),this.scene.time.delayedCall(16.67*i.startup,function(){t.currentMove===e&&t.createHitbox(e)}),i.projectile&&this.scene.time.delayedCall(16.67*i.startup,function(){t.createProjectile(e)}))}},{key:"createHitbox",value:function(e){var t=this.scene.combatSystem.createHitbox(this,e,this.facing);t&&(t.lifetime=t.moveData.active,this.hitboxes.push(t))}},{key:"createProjectile",value:function(e){this.scene.events.emit("createProjectile",{owner:this,move:e,x:this.x+("right"===this.facing?50:-50),y:this.y-20})}},{key:"endMove",value:function(){this.currentMove=null,this.moveFrame=0,this.state="idle",this.animationLocked=!1}},{key:"walk",value:function(e){"hitstun"!==this.state&&"blockstun"!==this.state&&(this.velocity.x=e*this.maxVelocity.x,this.state="walking",e>0?this.facing="right":e<0&&(this.facing="left"))}},{key:"jump",value:function(){this.grounded&&"hitstun"!==this.state&&"blockstun"!==this.state&&(this.velocity.y=-15,this.state="jumping",this.grounded=!1)}},{key:"crouch",value:function(e){this.airborne||"hitstun"===this.state||"blockstun"===this.state||(this.crouching=e,e?(this.hurtbox.height=100,this.hurtbox.y=25):(this.hurtbox.height=150,this.hurtbox.y=0))}},{key:"block",value:function(e){"hitstun"!==this.state&&(this.blocking=e,e?(this.state="blocking",this.velocity.x*=.5):"blocking"===this.state&&(this.state="idle"))}},{key:"takeDamage",value:function(e,t){this.health=Math.max(0,this.health-e),this.scene.events.emit("fighterHit",{fighter:this,damage:e,hitResult:t}),this.health<=0&&this.onDefeat()}},{key:"onDefeat",value:function(){this.state="defeat",this.animationLocked=!0,this.sprite.play("".concat(this.config.texture,"_defeat")),this.scene.events.emit("fighterDefeated",{fighter:this})}},{key:"getHurtbox",value:function(){return this.hurtbox.active?{x:this.x+this.hurtbox.x,y:this.y+this.hurtbox.y,width:this.hurtbox.width,height:this.hurtbox.height,owner:this}:null}},{key:"getHitboxes",value:function(){var e=this;return this.hitboxes.map(function(t){return te(te({},t),{},{x:e.x+("right"===e.facing?t.x:-t.x),y:e.y+t.y,attacker:e})})}},{key:"reset",value:function(){this.health=this.maxHealth,this.state="idle",this.velocity={x:0,y:0},this.grounded=!0,this.airborne=!1,this.crouching=!1,this.blocking=!1,this.currentMove=null,this.moveFrame=0,this.invincibleFrames=0,this.armorFrames=0,this.juggleCount=0,this.hitboxes=[],this.inputBuffer=[],this.animationLocked=!1}}])&&ne(t.prototype,i),n&&ne(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n}();function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a,o,s=[],c=!0,u=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=a.call(i)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fe(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function pe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,de(n.key),n)}}function de(e){var t=function(e,t){if("object"!=le(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==le(t)?t:t+""}function ye(e,t,i){return t=ge(t),function(e,t){if(t&&("object"==le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,me()?Reflect.construct(t,i||[],ge(e).constructor):t.apply(e,i))}function me(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(me=function(){return!!e})()}function ve(){return ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ge(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(arguments.length<3?e:i):r.value}},ve.apply(null,arguments)}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(e)}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}var ke=function(){function e(t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ye(this,e,[t,0,0])).scene=t,i.enabled=!0,i.config={dpadSize:150,buttonSize:80,buttonSpacing:100,opacity:.7,vibrateOnTouch:!0},i.inputState={direction:null,buttons:new Set},i.gestureBuffer=[],i.gestureWindow=500,i.createDPad(),i.createActionButtons(),i.createSpecialButtons(),t.add.existing(i),i.setScrollFactor(0),i.setDepth(1e3),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(e,Phaser.GameObjects.Container),t=e,i=[{key:"createDPad",value:function(){var e=this,t=150,i=this.scene.game.config.height-200;this.dpadBg=this.scene.add.circle(t,i,this.config.dpadSize/2,0,.3),this.add(this.dpadBg),this.dpadZones={up:this.createDPadZone(t,i-50,"UP"),down:this.createDPadZone(t,i+50,"DOWN"),left:this.createDPadZone(100,i,"LEFT"),right:this.createDPadZone(200,i,"RIGHT"),upLeft:this.createDPadZone(115,i-35,"UP_LEFT",40),upRight:this.createDPadZone(185,i-35,"UP_RIGHT",40),downLeft:this.createDPadZone(115,i+35,"DOWN_LEFT",40),downRight:this.createDPadZone(185,i+35,"DOWN_RIGHT",40)},this.dpadVisuals={up:this.scene.add.triangle(t,i-50,0,15,-15,-15,15,-15,16777215,.5),down:this.scene.add.triangle(t,i+50,0,-15,-15,15,15,15,16777215,.5),left:this.scene.add.triangle(100,i,15,0,-15,-15,-15,15,16777215,.5),right:this.scene.add.triangle(200,i,-15,0,15,-15,15,15,16777215,.5)},Object.values(this.dpadVisuals).forEach(function(t){return e.add(t)}),this.scene.input.on("pointerdown",this.onDPadTouch,this),this.scene.input.on("pointermove",this.onDPadMove,this),this.scene.input.on("pointerup",this.onDPadRelease,this)}},{key:"createDPadZone",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:60,r=this.scene.add.zone(e,t,n,n);return r.setInteractive(),r.direction=i,r}},{key:"createActionButtons",value:function(){var e=this,t=this.scene.game.config.width-300,i=this.scene.game.config.height-250,n=[{id:"LP",x:t-this.config.buttonSpacing,y:i,label:"LP",color:39423},{id:"MP",x:t,y:i,label:"MP",color:26316},{id:"HP",x:t+this.config.buttonSpacing,y:i,label:"HP",color:13209},{id:"LK",x:t-this.config.buttonSpacing,y:i+this.config.buttonSpacing,label:"LK",color:16750848},{id:"MK",x:t,y:i+this.config.buttonSpacing,label:"MK",color:13395456},{id:"HK",x:t+this.config.buttonSpacing,y:i+this.config.buttonSpacing,label:"HK",color:10040064}];this.actionButtons={},n.forEach(function(t){var i=e.createButton(t);e.actionButtons[t.id]=i})}},{key:"createSpecialButtons",value:function(){var e=this.createButton({id:"BLOCK",x:this.scene.game.config.width-400,y:this.scene.game.config.height-350,label:"BLOCK",color:6710886,size:60}),t=this.createButton({id:"THROW",x:this.scene.game.config.width-200,y:this.scene.game.config.height-150,label:"THROW",color:10027263,size:60});this.actionButtons.BLOCK=e,this.actionButtons.THROW=t}},{key:"createButton",value:function(e){var t=this,i=this.scene.add.circle(e.x,e.y,e.size||this.config.buttonSize/2,e.color,this.config.opacity);i.setInteractive(),i.setStrokeStyle(3,16777215,.8);var n=this.scene.add.text(e.x,e.y,e.label,{font:"bold 20px Arial",fill:"#ffffff"});return n.setOrigin(.5,.5),i.on("pointerdown",function(){return t.onButtonPress(e.id)}),i.on("pointerup",function(){return t.onButtonRelease(e.id)}),i.on("pointerout",function(){return t.onButtonRelease(e.id)}),i.label=n,i.id=e.id,i.defaultColor=e.color,this.add([i,n]),i}},{key:"onDPadTouch",value:function(e){if(this.enabled)for(var t=0,i=Object.entries(this.dpadZones);t<i.length;t++){var n=he(i[t],2),r=n[0],a=n[1];if(a.getBounds().contains(e.x,e.y)){this.setDirection(a.direction),this.highlightDPad(r),this.addToGestureBuffer(a.direction),this.config.vibrateOnTouch&&window.navigator.vibrate&&window.navigator.vibrate(10);break}}}},{key:"onDPadMove",value:function(e){if(this.enabled&&e.isDown){var t=this.scene.game.config.height-200,i=Phaser.Math.Angle.Between(150,t,e.x,e.y);if(Phaser.Math.Distance.Between(150,t,e.x,e.y)<this.config.dpadSize/2){var n=this.angleToDirection(i);n!==this.inputState.direction&&(this.setDirection(n),this.addToGestureBuffer(n))}else this.setDirection(null)}}},{key:"onDPadRelease",value:function(){this.setDirection(null),this.resetDPadHighlight()}},{key:"angleToDirection",value:function(e){var t=Phaser.Math.RadToDeg(e);return t<0&&(t+=360),t>=337.5||t<22.5?"RIGHT":t>=22.5&&t<67.5?"DOWN_RIGHT":t>=67.5&&t<112.5?"DOWN":t>=112.5&&t<157.5?"DOWN_LEFT":t>=157.5&&t<202.5?"LEFT":t>=202.5&&t<247.5?"UP_LEFT":t>=247.5&&t<292.5?"UP":t>=292.5&&t<337.5?"UP_RIGHT":null}},{key:"setDirection",value:function(e){var t=this.inputState.direction;this.inputState.direction=e,e!==t&&(t&&this.sendInput(t+"_RELEASE"),e&&this.sendInput(e))}},{key:"highlightDPad",value:function(e){this.resetDPadHighlight(),this.dpadVisuals[e]&&(this.dpadVisuals[e].setAlpha(1),this.dpadVisuals[e].setScale(1.2))}},{key:"resetDPadHighlight",value:function(){Object.values(this.dpadVisuals).forEach(function(e){e.setAlpha(.5),e.setScale(1)})}},{key:"onButtonPress",value:function(e){if(this.enabled){var t=this.actionButtons[e];t&&(t.setScale(1.2),t.setAlpha(1),this.config.vibrateOnTouch&&window.navigator.vibrate&&window.navigator.vibrate(20),this.inputState.buttons.add(e),"THROW"===e?(this.sendInput("LP"),this.sendInput("LK")):this.sendInput(e),this.addToGestureBuffer(e))}}},{key:"onButtonRelease",value:function(e){var t=this.actionButtons[e];t&&(t.setScale(1),t.setAlpha(this.config.opacity),this.inputState.buttons.delete(e),"BLOCK"===e?this.sendInput("BLOCK_RELEASE"):"THROW"===e&&(this.sendInput("LP_RELEASE"),this.sendInput("LK_RELEASE")))}},{key:"addToGestureBuffer",value:function(e){var t=this,i=Date.now();this.gestureBuffer=this.gestureBuffer.filter(function(e){return i-e.timestamp<t.gestureWindow}),this.gestureBuffer.push({input:e,timestamp:i}),this.checkGestures()}},{key:"checkGestures",value:function(){var e=this.gestureBuffer.map(function(e){return e.input}).join(",");e.includes("DOWN,DOWN_RIGHT,RIGHT")&&this.onSpecialMoveDetected("QCF"),e.includes("DOWN,DOWN_LEFT,LEFT")&&this.onSpecialMoveDetected("QCB"),(e.includes("RIGHT,DOWN,DOWN_RIGHT")||e.includes("LEFT,DOWN,DOWN_LEFT"))&&this.onSpecialMoveDetected("DP"),e.includes("LEFT,DOWN_LEFT,DOWN,DOWN_RIGHT,RIGHT")&&this.onSpecialMoveDetected("HCF"),e.includes("RIGHT,DOWN_RIGHT,DOWN,DOWN_LEFT,LEFT")&&this.onSpecialMoveDetected("HCB")}},{key:"onSpecialMoveDetected",value:function(e){var t=this;this.dpadBg.setStrokeStyle(4,16776960,1),this.scene.time.delayedCall(200,function(){t.dpadBg.setStrokeStyle(0)}),window.navigator.vibrate&&window.navigator.vibrate([30,10,30])}},{key:"sendInput",value:function(e){this.scene.bridge&&this.scene.bridge.send("GAME_INPUT",{action:e}),this.scene.handleInput({action:e})}},{key:"setEnabled",value:function(e){this.enabled=e,this.setAlpha(e?1:.3)}},{key:"setOpacity",value:function(e){this.config.opacity=e,Object.values(this.actionButtons).forEach(function(t){t.setAlpha(e)}),this.dpadBg.setAlpha(.5*e)}},{key:"setLayout",value:function(e){var t=this;if(e.buttons&&Object.entries(e.buttons).forEach(function(e){var i=he(e,2),n=i[0],r=i[1],a=t.actionButtons[n];a&&(a.x=r.x,a.y=r.y,a.label.x=r.x,a.label.y=r.y)}),e.dpad){var i=e.dpad.x-150,n=e.dpad.y-(this.scene.game.config.height-200);this.dpadBg.x+=i,this.dpadBg.y+=n,Object.values(this.dpadZones).forEach(function(e){e.x+=i,e.y+=n}),Object.values(this.dpadVisuals).forEach(function(e){e.x+=i,e.y+=n})}}},{key:"destroy",value:function(){var t,i,n,r,a;this.scene.input.off("pointerdown",this.onDPadTouch,this),this.scene.input.off("pointermove",this.onDPadMove,this),this.scene.input.off("pointerup",this.onDPadRelease,this),(t=e,i="destroy",n=this,a=ve(ge(1&(r=3)?t.prototype:t),i,n),2&r&&"function"==typeof a?function(e){return a.apply(n,e)}:a)([])}}],i&&pe(t.prototype,i),n&&pe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n}();function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Se(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pe(n.key),n)}}function Pe(e){var t=function(e,t){if("object"!=we(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=we(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==we(t)?t:t+""}function xe(e,t,i){return t=Me(t),function(e,t){if(t&&("object"==we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Oe()?Reflect.construct(t,i||[],Me(e).constructor):t.apply(e,i))}function Oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Oe=function(){return!!e})()}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}function _e(e,t){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_e(e,t)}var Te=function(){function e(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xe(this,e,[{key:"BattleScene"}])).assetManager=null,t.combatSystem=null,t.bossAI=null,t.player=null,t.opponent=null,t.stage=null,t.projectiles=[],t.battleState={round:1,timer:99,timerMs:99e3,isPaused:!1,isRoundOver:!1,frameCount:0},t.lastUpdateTime=0,t.updateDelta=16.67,t.groundY=800,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_e(e,t)}(e,Phaser.Scene),t=e,(i=[{key:"init",value:function(e){this.battleData=e||{characterId:"default",opponentId:"boss_1",stageId:"dojo",difficulty:"normal"},this.resetBattleState()}},{key:"preload",value:function(){this.assetManager=new A(this),this.assetManager.loadCombatAssets(this.battleData)}},{key:"create",value:function(){this.combatSystem=new K(this),this.bossAI=new q(this,this.combatSystem),this.createStage(),this.createFighters(),this.createBattleUI(),this.setupInputHandling(),this.setupEventListeners(),this.bossAI.setBoss(this.battleData.opponentId,this.battleData.difficulty),this.startBattle()}},{key:"update",value:function(e,t){if(!this.battleState.isPaused&&!this.battleState.isRoundOver){var i=Math.min(t,33.33);this.battleState.frameCount++,this.updateInput(i),this.combatSystem.update(),this.updateFighters(i),this.updateCollisions(),this.updateProjectiles(i),this.updateBattleLogic(i),this.updateUI(i),this.lastUpdateTime=e}}},{key:"createStage",value:function(){var e="stage_".concat(this.battleData.stageId);this.textures.exists(e)?(this.stage=this.add.image(960,540,e),this.stage.setDepth(-10)):this.add.rectangle(960,540,1920,1080,2763338);var t=this.add.rectangle(960,980,1920,200,0,0);this.physics.add.existing(t,!0),this.ground=t}},{key:"createFighters",value:function(){this.player=new ue(this,480,this.groundY,{player:"p1",characterId:this.battleData.characterId,texture:"character_".concat(this.battleData.characterId),facing:"right",groundY:this.groundY,isAI:!1});var e=this.bossAI.bossPatterns[this.battleData.opponentId];this.opponent=new ue(this,1440,this.groundY,{player:"p2",characterId:this.battleData.opponentId,texture:"boss_".concat(this.battleData.opponentId),facing:"left",groundY:this.groundY,isAI:!0,maxHealth:(null==e?void 0:e.health)||100,defense:(null==e?void 0:e.defense)||0}),this.updateFacing()}},{key:"updateFacing",value:function(){this.player.x<this.opponent.x?(this.player.facing="right",this.opponent.facing="left"):(this.player.facing="left",this.opponent.facing="right")}},{key:"createFighterAnimations",value:function(e,t){var i=this;[{key:"idle",frames:[0,1,2,3],frameRate:10,repeat:-1},{key:"walk",frames:[4,5,6,7],frameRate:12,repeat:-1},{key:"jump",frames:[8,9],frameRate:10,repeat:0},{key:"punch",frames:[12,13,14],frameRate:20,repeat:0},{key:"kick",frames:[16,17,18],frameRate:20,repeat:0},{key:"hit",frames:[20,21],frameRate:15,repeat:0},{key:"block",frames:[24],frameRate:10,repeat:0}].forEach(function(e){i.anims.exists("".concat(t,"_").concat(e.key))||i.anims.create({key:"".concat(t,"_").concat(e.key),frames:i.anims.generateFrameNumbers(t,{frames:e.frames}),frameRate:e.frameRate,repeat:e.repeat})})}},{key:"createBattleUI",value:function(){this.createHealthBar(100,50,!0),this.createHealthBar(1820,50,!1),this.timerText=this.add.text(960,50,"99",{font:"48px Arial",fill:"#ffffff",stroke:"#000000",strokeThickness:4}),this.timerText.setOrigin(.5,.5),this.roundText=this.add.text(960,100,"ROUND ".concat(this.battleState.round),{font:"32px Arial",fill:"#ffff00",stroke:"#000000",strokeThickness:3}),this.roundText.setOrigin(.5,.5),this.comboText=this.add.text(100,200,"",{font:"36px Arial",fill:"#ff6600",stroke:"#000000",strokeThickness:3})}},{key:"createHealthBar",value:function(e,t,i){var n=400;this.add.rectangle(e,t,404,34,0).setOrigin(i?0:1,.5);var r=this.add.rectangle(e,t,n,30,65280);r.setOrigin(i?0:1,.5),i?(this.playerHealthBar=r,this.playerHealthBarWidth=n):(this.opponentHealthBar=r,this.opponentHealthBarWidth=n)}},{key:"setupInputHandling",value:function(){var e=this;this.game.device.input.touch&&(this.touchControls=new ke(this),this.touchControls.bridge=p),p.on("GAME_INPUT",function(t){e.handleInput(t)}),window.ReactNativeWebView||this.setupKeyboardControls()}},{key:"setupKeyboardControls",value:function(){var e=this.input.keyboard.createCursorKeys(),t=this.input.keyboard.addKeys("W,A,S,D,J,K,L,U,I,O");this.cursors=e,this.keys=t}},{key:"setupEventListeners",value:function(){this.events.on("fighterHit",this.onFighterHit,this),this.events.on("fighterDefeated",this.onFighterDefeated,this),this.events.on("createProjectile",this.createProjectile,this),this.events.on("comboHit",this.onComboHit,this),this.events.on("superActivated",this.onSuperActivated,this)}},{key:"startBattle",value:function(){var e=this;this.showAnnouncement("FIGHT!",function(){e.battleState.isPaused=!1,e.startTimer()}),p.send("BATTLE_STARTED",{characterId:this.battleData.characterId,opponentId:this.battleData.opponentId,timestamp:Date.now()})}},{key:"showAnnouncement",value:function(e,t){var i=this,n=this.add.text(960,540,e,{font:"72px Arial",fill:"#ffffff",stroke:"#ff0000",strokeThickness:6});n.setOrigin(.5,.5),n.setScale(0),this.tweens.add({targets:n,scale:1,duration:300,ease:"Back.easeOut",onComplete:function(){i.time.delayedCall(500,function(){i.tweens.add({targets:n,scale:0,duration:200,onComplete:function(){n.destroy(),t&&t()}})})}})}},{key:"handleInput",value:function(e){this.battleState.isPaused||this.battleState.isRoundOver||(this.inputBuffer.push({action:e.action,timestamp:performance.now()}),this.inputBuffer.length>10&&this.inputBuffer.shift(),this.processInput(e))}},{key:"processInput",value:function(e){var t=this,i={MOVE_LEFT:function(){return t.player.walk(-1)},MOVE_RIGHT:function(){return t.player.walk(1)},MOVE_NEUTRAL:function(){return t.player.walk(0)},JUMP:function(){return t.player.jump()},CROUCH:function(){return t.player.crouch(!0)},CROUCH_RELEASE:function(){return t.player.crouch(!1)},BLOCK:function(){return t.player.block(!0)},BLOCK_RELEASE:function(){return t.player.block(!1)},LP:function(){return t.player.handleInput("LP")},MP:function(){return t.player.handleInput("MP")},HP:function(){return t.player.handleInput("HP")},LK:function(){return t.player.handleInput("LK")},MK:function(){return t.player.handleInput("MK")},HK:function(){return t.player.handleInput("HK")},THROW:function(){return t.player.handleInput("THROW")}}[e.action];i&&i(),(e.action.includes("DOWN")||e.action.includes("FORWARD")||e.action.includes("BACK")||e.action.includes("UP"))&&this.player.handleInput(e.action)}},{key:"updateInput",value:function(e){this.cursors&&!window.ReactNativeWebView&&(this.cursors.left.isDown?this.movePlayer(-1):this.cursors.right.isDown&&this.movePlayer(1),this.cursors.up.isDown&&this.jumpPlayer(),Phaser.Input.Keyboard.JustDown(this.keys.J)&&this.performAttack("punch_light"))}},{key:"updateFighters",value:function(e){this.player.update(e),this.opponent.update(e),this.updateFacing(),this.updateAI(e)}},{key:"updateFighter",value:function(e,t){0!==e.body.velocity.y?e.state="airborne":Math.abs(e.body.velocity.x)>50?e.state="walking":"attacking"!==e.state&&(e.state="idle"),this.updateFighterAnimation(e)}},{key:"updateFighterAnimation",value:function(e){var t,i,n=e.texture.key;switch(e.state){case"idle":(null===(t=e.anims.currentAnim)||void 0===t?void 0:t.key)!=="".concat(n,"_idle")&&e.play("".concat(n,"_idle"));break;case"walking":(null===(i=e.anims.currentAnim)||void 0===i?void 0:i.key)!=="".concat(n,"_walk")&&e.play("".concat(n,"_walk"))}}},{key:"updateBattleLogic",value:function(e){this.battleState.isRoundOver||this.updateTimer(e),this.checkWinConditions()}},{key:"updateTimer",value:function(e){this.battleState.timerMs=(this.battleState.timerMs||99e3)-e,this.battleState.timerMs<=0?(this.battleState.timer=0,this.endRound("timeout")):(this.battleState.timer=Math.ceil(this.battleState.timerMs/1e3),this.timerText.setText(this.battleState.timer))}},{key:"updateUI",value:function(e){var t=this.player.health/this.player.maxHealth,i=this.opponent.health/this.opponent.maxHealth;this.playerHealthBar.width=t*this.playerHealthBarWidth,this.opponentHealthBar.width=i*this.opponentHealthBarWidth,t<.3?this.playerHealthBar.setFillStyle(16711680):t<.6&&this.playerHealthBar.setFillStyle(16776960),i<.3?this.opponentHealthBar.setFillStyle(16711680):i<.6&&this.opponentHealthBar.setFillStyle(16776960);var n=this.combatSystem.comboCounts.p1;n>1?(this.comboText.setText("".concat(n," HIT COMBO!")),this.comboText.setScale(1+.1*n)):this.comboText.setText(""),this.updateSuperMeters()}},{key:"processAIAction",value:function(e){var t=this,i={MOVE_LEFT:function(){return t.opponent.walk(-1)},MOVE_RIGHT:function(){return t.opponent.walk(1)},JUMP:function(){return t.opponent.jump()},CROUCH:function(){return t.opponent.crouch(!0)},BLOCK:function(){return t.opponent.block(!0)},BLOCK_RELEASE:function(){return t.opponent.block(!1)},LP:function(){return t.opponent.handleInput("LP")},MP:function(){return t.opponent.handleInput("MP")},HP:function(){return t.opponent.handleInput("HP")},LK:function(){return t.opponent.handleInput("LK")},MK:function(){return t.opponent.handleInput("MK")},HK:function(){return t.opponent.handleInput("HK")},THROW:function(){return t.opponent.handleInput("THROW")}};if(this.bossAI.currentBoss.specialMoves&&this.bossAI.currentBoss.specialMoves[e])this.opponent.handleInput(e);else{var n=i[e];n&&n()}}},{key:"jumpPlayer",value:function(){this.player.body.blocked.down&&"attacking"!==this.player.state&&this.player.setVelocityY(-600)}},{key:"performAttack",value:function(e){var t=this;if("attacking"!==this.player.state){this.player.state="attacking";var i=this.createHitbox(this.player,e),n=e.includes("punch")?"punch":"kick";this.player.play("".concat(this.player.texture.key,"_").concat(n)),this.player.once("animationcomplete",function(){t.player.state="idle",i.destroy()})}}},{key:"createHitbox",value:function(e,t){var i=this.getHitboxData(t),n=e.x+(e.flipX?-i.offsetX:i.offsetX),r=e.y+i.offsetY,a=this.add.rectangle(n,r,i.width,i.height,16711680,0);return this.physics.add.existing(a),a.attacker=e,a.damage=i.damage,a.hitstun=i.hitstun,this.hitboxGroup.add(a),this.time.delayedCall(16.67*i.activeFrames,function(){a.destroy()}),a}},{key:"getHitboxData",value:function(e){var t={punch_light:{width:60,height:40,offsetX:50,offsetY:-20,damage:5,hitstun:200,activeFrames:3},punch_heavy:{width:80,height:50,offsetX:60,offsetY:-20,damage:10,hitstun:400,activeFrames:5},kick_light:{width:70,height:60,offsetX:55,offsetY:0,damage:7,hitstun:300,activeFrames:4},kick_heavy:{width:90,height:70,offsetX:65,offsetY:0,damage:12,hitstun:500,activeFrames:6}};return t[e]||t.punch_light}},{key:"setBlocking",value:function(e){this.player.isBlocking=e,e&&this.player.play("".concat(this.player.texture.key,"_block"))}},{key:"checkSpecialMoves",value:function(){var e=this.inputBuffer.slice(-3);if(e.length>=3){var t=e.map(function(e){return e.action});t.includes("DOWN")&&t.includes("DOWN_RIGHT")&&t.includes("RIGHT")&&this.performSpecialMove("hadouken")}}},{key:"performSpecialMove",value:function(e){}},{key:"updateAI",value:function(e){if(this.opponent&&!this.battleState.isRoundOver){var t={currentFrame:this.battleState.frameCount,round:this.battleState.round},i=this.bossAI.update(this.opponent,this.player,t);i&&this.processAIAction(i)}}},{key:"performAIAttack",value:function(){var e=this;this.opponent.state="attacking";var t=Phaser.Math.RND.pick(["punch_light","punch_heavy","kick_light","kick_heavy"]),i=(this.createHitbox(this.opponent,t),t.includes("punch")?"punch":"kick");this.opponent.play("".concat(this.opponent.texture.key,"_").concat(i)),this.opponent.once("animationcomplete",function(){e.opponent.state="idle"})}},{key:"onFighterCollision",value:function(e,t){var i=100;e.x<t.x?(e.setVelocityX(-100),t.setVelocityX(i)):(e.setVelocityX(i),t.setVelocityX(-100))}},{key:"updateCollisions",value:function(){var e=this,t=this.player.getHitboxes(),i=this.opponent.getHitboxes();t.forEach(function(t){var i=e.opponent.getHurtbox();if(i){var n=e.combatSystem.checkHit(t,e.opponent,i);n&&(e.combatSystem.applyHit(n,e.player,e.opponent),e.createHitEffect(n,e.opponent))}}),i.forEach(function(t){var i=e.player.getHurtbox();if(i){var n=e.combatSystem.checkHit(t,e.player,i);n&&(e.combatSystem.applyHit(n,e.opponent,e.player),e.createHitEffect(n,e.player))}}),this.checkProjectileCollisions()}},{key:"isFacingAttacker",value:function(e,t){var i=e.flipX,n=t.x>e.x;return i&&n||!i&&!n}},{key:"onBlocked",value:function(e,t){var i=.1*t.damage;this.dealDamage(e,i),this.createBlockEffect(e.x,e.y);var n=e.x<t.x?-1:1;e.setVelocityX(200*n),this.sound.get("block")&&this.sound.play("block")}},{key:"onHit",value:function(e,t){var i=this;this.dealDamage(e,t.damage),this.createHitEffect(e.x,e.y),e.state="hitstun",this.time.delayedCall(t.hitstun,function(){"hitstun"===e.state&&(e.state="idle")});var n=e.x<t.x?-1:1;e.setVelocityX(300*n),e.setVelocityY(-200),t.attacker===this.player&&(this.player.comboCount++,this.time.delayedCall(1e3,function(){i.player.comboCount=0}));var r=t.damage>8?"hit_heavy":"hit_light";this.sound.get(r)&&this.sound.play(r)}},{key:"dealDamage",value:function(e,t){e===this.player?this.battleState.playerHealth=Math.max(0,this.battleState.playerHealth-t):this.battleState.opponentHealth=Math.max(0,this.battleState.opponentHealth-t)}},{key:"createHitEffect",value:function(e,t){var i=t.x,n=t.y-30;if(e.blocked)this.createBlockEffect(i,n),this.sound.get("block")&&this.sound.play("block");else{if(this.anims.exists("hit_spark")){var r=this.add.sprite(i,n,"ui_atlas");r.play("hit_spark"),r.once("animationcomplete",function(){return r.destroy()})}var a=e.damage>30?"hit_heavy":"hit_light";this.sound.get(a)&&this.sound.play(a),e.damage>40&&this.cameras.main.shake(100,.01)}this.createDamageNumber(i,n-50,e.damage)}},{key:"createBlockEffect",value:function(e,t){if(this.anims.exists("block_spark")){var i=this.add.sprite(e,t,"ui_atlas");i.play("block_spark"),i.once("animationcomplete",function(){return i.destroy()})}}},{key:"updateSuperMeters",value:function(){this.playerSuperBar||(this.playerSuperBar=this.add.rectangle(100,120,0,20,65535),this.playerSuperBar.setOrigin(0,.5),this.playerSuperBarBg=this.add.rectangle(100,120,300,20,13158),this.playerSuperBarBg.setOrigin(0,.5),this.playerSuperBarBg.setDepth(-1)),this.opponentSuperBar||(this.opponentSuperBar=this.add.rectangle(1820,120,0,20,65535),this.opponentSuperBar.setOrigin(1,.5),this.opponentSuperBarBg=this.add.rectangle(1820,120,300,20,13158),this.opponentSuperBarBg.setOrigin(1,.5),this.opponentSuperBarBg.setDepth(-1));var e=this.combatSystem.superMeters.p1/this.combatSystem.superMeterMax,t=this.combatSystem.superMeters.p2/this.combatSystem.superMeterMax;this.playerSuperBar.width=300*e,this.opponentSuperBar.width=300*t,e>=1&&(this.playerSuperBar.setFillStyle(16776960),this.playerSuperBar.setAlpha(.5+.5*Math.sin(.01*this.time.now))),t>=1&&(this.opponentSuperBar.setFillStyle(16776960),this.opponentSuperBar.setAlpha(.5+.5*Math.sin(.01*this.time.now)))}},{key:"createDamageNumber",value:function(e,t,i){var n=this.add.text(e,t,i.toString(),{font:"bold 32px Arial",fill:"#ffff00",stroke:"#000000",strokeThickness:4});n.setOrigin(.5,.5),this.tweens.add({targets:n,y:t-50,alpha:0,duration:800,ease:"Power2",onComplete:function(){return n.destroy()}})}},{key:"updateProjectiles",value:function(e){this.projectiles=this.projectiles.filter(function(e){return e.x+=e.velocity,e.lifetime--,!(e.x<-50||e.x>1970||e.lifetime<=0)||(e.destroy(),!1)})}},{key:"checkProjectileCollisions",value:function(){var e=this;this.projectiles.forEach(function(t){(t.owner===e.player?[e.opponent]:[e.player]).forEach(function(i){var n=i.getHurtbox();if(n&&e.combatSystem.checkBoxOverlap(t.x-25,t.y-25,50,50,n.x-n.width/2,n.y-n.height/2,n.width,n.height)){var r={hit:!0,blocked:i.blocking,damage:t.damage,hitstun:t.hitstun,pushback:t.pushback};e.combatSystem.applyHit(r,t.owner,i),e.createHitEffect(r,i),t.destroy(),e.projectiles=e.projectiles.filter(function(e){return e!==t})}})})}},{key:"createProjectile",value:function(e){var t=this.combatSystem.frameData.get(e.move);if(t&&t.projectile){var i=this.add.sprite(e.x,e.y,"projectile_"+e.move);i.owner=e.owner,i.velocity="right"===e.owner.facing?t.projectileSpeed:-t.projectileSpeed,i.damage=t.damage,i.hitstun=t.hitstun,i.pushback=t.pushback,i.lifetime=120,this.anims.exists("projectile_"+e.move)&&i.play("projectile_"+e.move),this.projectiles.push(i)}}},{key:"onFighterHit",value:function(e){this.updateUI(0),e.damage>40&&this.cameras.main.shake(150,.015)}},{key:"onFighterDefeated",value:function(e){this.battleState.isRoundOver=!0;var t=e.fighter===this.player?"opponent_win":"player_win";this.endRound(t)}},{key:"onComboHit",value:function(e){e.comboCount>=5&&this.cameras.main.flash(100,255,255,0)}},{key:"onSuperActivated",value:function(e){var t=this;this.scene.pause();var i=this.add.rectangle(960,540,1920,1080,16777215);i.setAlpha(0),this.tweens.add({targets:i,alpha:1,duration:100,yoyo:!0,onComplete:function(){i.destroy(),t.scene.resume()}}),this.sound.get("super_activate")&&this.sound.play("super_activate")}},{key:"checkWinConditions",value:function(){this.player.health<=0?this.endRound("opponent_win"):this.opponent.health<=0&&this.endRound("player_win")}},{key:"endRound",value:function(e){var t=this;this.battleState.isRoundOver=!0;var i="";switch(e){case"player_win":i="YOU WIN!";break;case"opponent_win":i="YOU LOSE!";break;case"timeout":i="TIME OUT!"}this.showAnnouncement(i,function(){t.endBattle(e)})}},{key:"endBattle",value:function(e){var t=this.calculateScore();p.send("BATTLE_COMPLETE",{result:e,score:t,playerHealth:this.battleState.playerHealth,opponentHealth:this.battleState.opponentHealth,combosLanded:this.player.comboCount,timestamp:Date.now()})}},{key:"calculateScore",value:function(){var e=0;return this.battleState.playerHealth>0&&(e+=1e3),e+=10*this.battleState.playerHealth,e+=5*this.battleState.timer,e+=100*this.player.comboCount}},{key:"resetBattleState",value:function(){this.battleState={round:1,timer:99,timerMs:99e3,playerHealth:100,opponentHealth:100,isPaused:!1,isRoundOver:!1}}},{key:"startTimer",value:function(){this.battleState.timerMs=99e3}},{key:"updateCharacterData",value:function(e){this.player&&e.stats&&(this.player.attackPower=e.stats.attack||1,this.player.defense=e.stats.defense||1,this.player.speed=e.stats.speed||1,this.player.setMaxVelocity(600*this.player.speed,800))}},{key:"cleanup",value:function(){this.hitboxGroup.clear(!0,!0),this.hurtboxGroup.clear(!0,!0),this.inputBuffer=[]}},{key:"shutdown",value:function(){p.off("GAME_INPUT",this.handleInput),p.off("UPDATE_CHARACTER",this.updateCharacterData),this.cleanup()}}])&&Se(t.prototype,i),n&&Se(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n}();function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function De(e){return function(e){if(Array.isArray(e))return Ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ce(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function Be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,He(n.key),n)}}function He(e){var t=function(e,t){if("object"!=Ae(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ae(t)?t:t+""}var Ee=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.currentQuality="HIGH",this.targetFPS=60,this.fpsHistory=[],this.historySize=60,this.thresholds={upgrade:{fps:58,duration:5e3},downgrade:{fps:50,duration:2e3},critical:{fps:30,duration:500}},this.isMonitoring=!1,this.lastQualityChange=0,this.qualityChangeTimeout=1e4,this.metrics={avgFPS:0,minFPS:60,maxFPS:60,drawCalls:0,textureCount:0,triangles:0,lastFrameTime:0,deltaTime:0,memoryUsage:0},this.frameTimes=[],this.maxFrameTime=1e3/30,this.setupMonitoring()},(t=[{key:"setupMonitoring",value:function(){var e=this;this.game.events.on("preupdate",this.onPreUpdate,this),this.game.events.on("postupdate",this.onPostUpdate,this),this.evaluationInterval=setInterval(function(){e.isMonitoring&&e.evaluatePerformance()},1e3),this.memoryInterval=setInterval(function(){e.isMonitoring&&e.checkMemoryUsage()},5e3)}},{key:"start",value:function(){this.isMonitoring=!0,this.lastFrameTime=performance.now(),this.applyQualityPreset(this.currentQuality),p.send("PERFORMANCE_MONITORING_STARTED",{quality:this.currentQuality,targetFPS:this.targetFPS})}},{key:"stop",value:function(){this.isMonitoring=!1,clearInterval(this.evaluationInterval),clearInterval(this.memoryInterval)}},{key:"onPreUpdate",value:function(e,t){if(this.isMonitoring){var i=performance.now();this.metrics.deltaTime=t;var n=i-this.lastFrameTime;this.frameTimes.push(n),this.frameTimes.length>this.historySize&&this.frameTimes.shift(),this.lastFrameTime=i}}},{key:"onPostUpdate",value:function(){if(this.isMonitoring){var e=this.game.loop.actualFps;this.fpsHistory.push(e),this.fpsHistory.length>this.historySize&&this.fpsHistory.shift(),this.updateMetrics(),e<this.thresholds.critical.fps&&this.handleCriticalPerformance()}}},{key:"updateMetrics",value:function(){if(0!==this.fpsHistory.length){var e=this.fpsHistory.reduce(function(e,t){return e+t},0);if(this.metrics.avgFPS=e/this.fpsHistory.length,this.metrics.minFPS=Math.min.apply(Math,De(this.fpsHistory)),this.metrics.maxFPS=Math.max.apply(Math,De(this.fpsHistory)),this.game.renderer.type===Phaser.WEBGL){var t=this.game.renderer;this.metrics.drawCalls=t.drawingBufferHeight,this.metrics.textureCount=t.textureIndexes.length}}}},{key:"evaluatePerformance",value:function(){if(!(Date.now()-this.lastQualityChange<this.qualityChangeTimeout)){var e=this.metrics.avgFPS,t=["ULTRA","HIGH","MEDIUM","LOW","POTATO"],i=t.indexOf(this.currentQuality);e>=this.thresholds.upgrade.fps&&i>0?this.changeQuality(t[i-1]):e<this.thresholds.downgrade.fps&&i<t.length-1&&this.changeQuality(t[i+1]),this.sendPerformanceReport()}}},{key:"handleCriticalPerformance",value:function(){var e=["ULTRA","HIGH","MEDIUM","LOW","POTATO"],t=e.indexOf(this.currentQuality);t<e.length-1&&(this.lastQualityChange=0,this.changeQuality(e[Math.min(t+2,e.length-1)]),p.send("CRITICAL_PERFORMANCE",{fps:this.game.loop.actualFps,quality:this.currentQuality}))}},{key:"changeQuality",value:function(e){if(e!==this.currentQuality){var t=this.currentQuality;this.currentQuality=e,this.lastQualityChange=Date.now(),this.applyQualityPreset(e),p.send("QUALITY_CHANGED",{from:t,to:e,reason:"performance",metrics:this.getPerformanceSnapshot()})}}},{key:"applyQualityPreset",value:function(e){var t=this,i=o[e];if(i&&(this.game.scene.scenes.forEach(function(e){e.scene.isActive()&&t.applySceneQuality(e,i)}),this.game.renderer.type===Phaser.WEBGL)){var n=this.game.renderer;n.config.batchSize="POTATO"===e?2048:"LOW"===e?3072:4096}}},{key:"applySceneQuality",value:function(e,t){e.particleManager&&e.particleManager.setMaxParticles(t.particleLimit),e.shadowRenderer&&e.shadowRenderer.setQuality(t.shadowQuality),e.background&&e.background.setComplexity(t.backgroundComplexity),e.effectsManager&&e.effectsManager.setEnabled(t.effectsEnabled),e.spritePool&&e.spritePool.setMaxSprites(t.maxSprites)}},{key:"checkMemoryUsage",value:function(){if(performance.memory){var e=performance.memory.usedJSHeapSize/1024/1024;if(this.metrics.memoryUsage=e,e>200&&(p.send("HIGH_MEMORY_WARNING",{usage:e,limit:200}),this.game.scene.getScene("BattleScene"))){var t=this.game.scene.getScene("BattleScene");t.assetManager&&t.assetManager.performMemoryCleanup()}}}},{key:"sendPerformanceReport",value:function(){p.send("PERFORMANCE_REPORT",{metrics:this.getPerformanceSnapshot(),quality:this.currentQuality,timestamp:Date.now()})}},{key:"getPerformanceSnapshot",value:function(){return{fps:{current:this.game.loop.actualFps,average:this.metrics.avgFPS,min:this.metrics.minFPS,max:this.metrics.maxFPS},frameTime:{average:this.calculateAverageFrameTime(),max:Math.max.apply(Math,De(this.frameTimes)),percentile95:this.calculate95thPercentile()},renderer:{drawCalls:this.metrics.drawCalls,textureCount:this.metrics.textureCount,type:this.game.renderer.type===Phaser.WEBGL?"WebGL":"Canvas"},memory:{usage:this.metrics.memoryUsage}}}},{key:"calculateAverageFrameTime",value:function(){return 0===this.frameTimes.length?0:this.frameTimes.reduce(function(e,t){return e+t},0)/this.frameTimes.length}},{key:"calculate95thPercentile",value:function(){if(0===this.frameTimes.length)return 0;var e=De(this.frameTimes).sort(function(e,t){return e-t});return e[Math.floor(.95*e.length)]}},{key:"setQualityPreset",value:function(e){o[e]&&(this.currentQuality=e,this.applyQualityPreset(e),this.lastQualityChange=Date.now())}},{key:"getMetrics",value:function(){return this.metrics}},{key:"forceGarbageCollection",value:function(){this.game.scene.scenes.forEach(function(e){e.scene.isActive()&&e.cleanup&&e.cleanup()}),window.gc&&window.gc()}},{key:"destroy",value:function(){this.stop(),this.game.events.off("preupdate",this.onPreUpdate,this),this.game.events.off("postupdate",this.onPostUpdate,this)}}])&&Be(e.prototype,t),i&&Be(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}function Re(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Ie(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(i),!0).forEach(function(t){Le(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Re(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function Le(e,t,i){return(t=Ne(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Fe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ne(n.key),n)}}function Ne(e){var t=function(e,t){if("object"!=je(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==je(t)?t:t+""}var We=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=null,this.performanceMonitor=null,this.isInitialized=!1,this.initialize()},(t=[{key:"initialize",value:function(){var e=this;if(window.ReactNativeWebView||"localhost"===window.location.hostname)this.createGame();else var t=0,i=setInterval(function(){(window.ReactNativeWebView||t>50)&&(clearInterval(i),e.createGame()),t++},100)}},{key:"createGame",value:function(){var e=Ie(Ie({},a),{},{scene:[w,L,Te]});this.game=new(r().Game)(e),p.attachGame(this.game),this.performanceMonitor=new Ee(this.game),this.setupGameEvents(),p.send("PHASER_INITIALIZED",{version:r().VERSION,renderer:this.game.renderer.type===r().WEBGL?"WebGL":"Canvas",audioContext:this.game.sound.context?"WebAudio":"HTML5Audio"}),this.isInitialized=!0}},{key:"setupGameEvents",value:function(){var e=this;this.game.events.on("ready",function(){e.onGameReady()}),this.game.events.on("pause",function(){p.send("GAME_PAUSED",{timestamp:Date.now()})}),this.game.events.on("resume",function(){p.send("GAME_RESUMED",{timestamp:Date.now()})}),this.game.events.on("destroy",function(){e.cleanup()}),this.setupBridgeHandlers()}},{key:"setupBridgeHandlers",value:function(){var e=this;p.on("UPDATE_CHARACTER",function(t){var i=e.game.scene.getScene("BattleScene");i&&i.scene.isActive()&&i.updateCharacterData(t)}),p.on("START_BATTLE",function(t){e.startBattle(t)}),p.on("GAME_INPUT",function(t){var i=e.game.scene.getScene("BattleScene");i&&i.scene.isActive()&&i.handleInput(t)}),p.on("SET_QUALITY",function(t){e.performanceMonitor.setQualityPreset(t)}),p.on("TOGGLE_DEBUG",function(t){e.game.config.physics.arcade.debug=t})}},{key:"onGameReady",value:function(){this.game.scene.start("BootScene"),this.performanceMonitor.start()}},{key:"startBattle",value:function(e){this.game.scene.start("BattleScene",e)}},{key:"cleanup",value:function(){this.performanceMonitor&&this.performanceMonitor.stop(),p.destroy(),this.isInitialized=!1}},{key:"pauseGame",value:function(){this.game&&!this.game.isPaused&&this.game.pause()}},{key:"resumeGame",value:function(){this.game&&this.game.isPaused&&this.game.resume()}},{key:"setVolume",value:function(e){this.game&&this.game.sound&&(this.game.sound.volume=Math.max(0,Math.min(1,e)))}},{key:"destroy",value:function(){this.game&&(this.game.destroy(!0),this.game=null)}}])&&Fe(e.prototype,t),i&&Fe(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}());window.SixteenBitFitGame=We}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var a=i[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,i,r,a)=>{if(!i){var o=1/0;for(l=0;l<e.length;l++){for(var[i,r,a]=e[l],s=!0,c=0;c<i.length;c++)(!1&a||o>=a)&&Object.keys(n.O).every(e=>n.O[e](i[c]))?i.splice(c--,1):(s=!1,a<o&&(o=a));if(s){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[i,r,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var r,a,[o,s,c]=i,u=0;if(o.some(t=>0!==e[t])){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)var l=c(n)}for(t&&t(i);u<o.length;u++)a=o[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(l)},i=self.webpackChunk_16bitfit_phaser_game=self.webpackChunk_16bitfit_phaser_game||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=n.O(void 0,[418],()=>n(429));r=n.O(r)})();